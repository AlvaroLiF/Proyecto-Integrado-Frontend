<body>
  <app-header-order></app-header-order>
  <div class="content">
    <h1>Dirección de envío</h1>
    <div class="form-and-summary">
      <div class="addresses">
    <div class="profile">
      <h2>Direcciones de Envío</h2>
      <div *ngIf="shippingAddresses && shippingAddresses.length > 0; else noShippingAddresses">
        <app-shipping-address-card
          *ngFor="let address of shippingAddresses"
          [address]="address"
          [isSelected]="address.isSelected"
          (select)="selectShippingAddress(address)"
          (edit)="editShippingAddress(address)"
          (delete)="deleteShippingAddress(address)">
        </app-shipping-address-card>
      </div>
      <ng-template #noShippingAddresses>
        <p>No hay direcciones de envío registradas.</p>
      </ng-template>
      <button (click)="openShippingModal(false)" class="btn btn-primary add-address-btn">+ Añadir otra dirección</button>
    </div>

    <div class="profile">
      <h2>Direcciones de facturación</h2>
      <div *ngIf="billingAddresses && billingAddresses.length > 0; else noBillingAddresses">
        <app-shipping-address-card
        *ngFor="let address of billingAddresses"
        [address]="address"
        [isSelected]="address.isSelected"
        (select)="selectBillingAddress(address)"
        (edit)="editShippingAddress(address)"
        (delete)="deleteShippingAddress(address)">
        </app-shipping-address-card>
      </div>
      <ng-template #noBillingAddresses>
        <p>No hay direcciones de facturación registradas.</p>
      </ng-template>
      <button (click)="openBillingModal(false)" class="btn btn-primary add-address-btn">+ Añadir otra dirección</button>
    </div>

    <app-shipping-address-modal
      [showModal]="showShippingModal"
      [shippingAddressForm]="shippingAddressForm"
      (closeModalEvent)="closeModal()"
      (saveAddressEvent)="saveShipAddress($event)">
    </app-shipping-address-modal>

    <app-billing-address-modal
      [showModal]="showBillingModal"
      [billingAddressForm]="billingAddressForm"
      (closeModalEvent)="closeModal()"
      (saveAddressEvent)="saveBillAddress($event)">
    </app-billing-address-modal>
  </div>
    <div class="order-summary">
      <h2>Resumen</h2>
      <p>Subtotal artículos {{ cart.totalPrice }}€</p>
      <hr class="separator">
      <h3>Total (Impuestos incluidos) {{ cart.totalPrice }}€</h3>
      <button (click)="saveAndContinue()">Guardar y Continuar</button>
    </div>
  </div>
</div>

  <app-footer></app-footer>
</body>